\subsubsection{Register Allocation and Coalescing}

Register allocation use linear scan method, its briefly steps as follows:

(1) we analyze liveness in function, for input and output find live in and live out.

(2) we insert spill and reload code, push it to worklist.

(3) we rewrite the virtual register for the target register.

While the steps for register coalescing is as follows:

(1) We traverse the \texttt{movrr} target instructions at basic block of function on the module.

(2) If the two registers of operands are the same, then we push the instructions into the work list.

(3) We can then remove the instructions in the work list from the function.